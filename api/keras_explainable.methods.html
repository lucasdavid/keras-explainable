<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="utf-8">
    <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <title>keras_explainable.methods package</title>
    

    <link rel="stylesheet" href="../_static/css/redactor.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/css/redactor.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    
    
    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Keras Explainable" href="../index.html"/>
    <link rel="up" title="keras_explainable package" href="keras_explainable.html"/>
    <link rel="prev" title="keras_explainable.engine package" href="keras_explainable.engine.html"/> 
</head>

<body role="document">
     

    
<a href="#" id="js-navigation-toggle" class="navigation-toggle">
    <i class="mdi mdi-menu"></i><i class="mdi mdi-close"></i>
</a>

<section class="site-sidebar">

<nav>


    <a href="../index.html" class="branding-link">
    
        keras-explainable
    
    
    
        
        
            <span class="branding-link__version">
                0.0.2
            </span>
        
    
    </a>

    
<section role="search">
    <form action="../search.html" method="get" class="site-searchform">
        <input type="text" name="q" placeholder="Search docs" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
</section>



    <section class="site-nav">
    
    
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explaining.html">Explaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exposure.html">Exposure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/index.html">Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wsol.html">WSSL &amp; WSSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Module Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="keras_explainable.html">keras_explainable package</a></li>
</ul>
</li>
</ul>

    
    </section>

</nav>

</section>

    <main class="site-main" role="main">
        











<nav class="site-breadcrumbs">
    <ul>
    
        <li>
            <a href="../index.html">Docs</a> /
        </li>
        
        <li>
            <a href="modules.html">keras_explainable</a> /
        </li>
        
        <li>
            <a href="keras_explainable.html">keras_explainable package</a> /
        </li>
        
        <li class="site-breadcrumbs__leaf">keras_explainable.methods package</li>
    
    </ul>
</nav>
        <section class="site-content">
            <div class="container">
                
  <section id="keras-explainable-methods-package">
<h1>keras_explainable.methods package<a class="headerlink" href="#keras-explainable-methods-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-keras_explainable.methods.cams">
<span id="keras-explainable-methods-cams-module"></span><h2>keras_explainable.methods.cams module<a class="headerlink" href="#module-keras_explainable.methods.cams" title="Permalink to this heading">¶</a></h2>
<p>Implementation of various CAM-based AI explaining methods and techniques.</p>
<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.cams.cam">
<span class="sig-name descname"><span class="pre">cam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-3,</span> <span class="pre">-2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/cams.html#cam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.cams.cam" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the CAM Visualization Method.</p>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <code class="docutils literal notranslate"><span class="pre">L</span></code> is the number of labels
represented within the model’s output logits.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">indices</span></code> is passed, the specific logits indexed by elements in
this tensor are selected before the gradients are computed,
effectively reducing the columns in the jacobian, and the size of
the output explaining map.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">cams</span><span class="o">.</span><span class="n">cam</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Zhou, B., Khosla, A., Lapedriza, A., Oliva, A., &amp; Torralba, A. (2016).
Learning deep features for discriminative localization. In Proceedings
of the IEEE conference on computer vision and pattern
recognition (pp. 2921-2929). Available at:
<a class="reference external" href="https://arxiv.org/pdf/1512.04150.pdf">arxiv/1512.04150</a>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
<li><p><strong>logits_layer</strong> (<em>Callable</em><em>, </em><em>optional</em>) – filter before channel combining.
Defaults to tf.abs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and Class Activation Maps (CAMs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.cams.gradcam">
<span class="sig-name descname"><span class="pre">gradcam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-3,</span> <span class="pre">-2)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/cams.html#gradcam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.cams.gradcam" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Grad-CAM Visualization Method.</p>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <cite>L</cite> is the number of labels
represented within the model’s output logits.</p>
<p>If <cite>indices</cite> is passed, the specific logits indexed by elements in this
tensor are selected before the gradients are computed, effectively
reducing the columns in the jacobian, and the size of the output explaining map.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">cams</span><span class="o">.</span><span class="n">gradcam</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Selvaraju, R. R., Cogswell, M., Das, A., Vedantam, R., Parikh, D., &amp; Batra, D.
(2017). Grad-CAM: Visual explanations from deep networks via gradient-based
localization. In Proceedings of the IEEE international conference on computer
vision (pp. 618-626).
Available at: <a class="reference external" href="https://arxiv.org/abs/1610.02391">arxiv/1610.02391</a>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and Class Activation Maps (CAMs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.cams.gradcampp">
<span class="sig-name descname"><span class="pre">gradcampp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-3,</span> <span class="pre">-2)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/cams.html#gradcampp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.cams.gradcampp" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Grad-CAM++ Visualization Method.</p>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <cite>L</cite> is the number of labels
represented within the model’s output logits.</p>
<p>If <cite>indices</cite> is passed, the specific logits indexed by elements in this
tensor are selected before the gradients are computed, effectively
reducing the columns in the jacobian, and the size of the output explaining map.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">cams</span><span class="o">.</span><span class="n">gradcampp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Chattopadhay, A., Sarkar, A., Howlader, P., &amp; Balasubramanian, V. N.
(2018, March). Grad-cam++: Generalized gradient-based visual explanations
for deep convolutional networks. In 2018 IEEE winter conference on
applications of computer vision (WACV) (pp. 839-847). IEEE.</p></li>
<li><p>Grad-CAM++’s official implementation. Github. Available at:
<a class="reference external" href="github.com/adityac94/Grad_CAM_plus_plus">adityac94/Grad-CAM++</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and Class Activation Maps (CAMs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.cams.scorecam">
<span class="sig-name descname"><span class="pre">scorecam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-3,</span> <span class="pre">-2)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/cams.html#scorecam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.cams.scorecam" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Score-CAM Visualization Method.</p>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <cite>L</cite> is the number of labels
represented within the model’s output logits.</p>
<p>If <cite>indices</cite> is passed, the specific logits indexed by elements in this
tensor are selected before the gradients are computed, effectively
reducing the columns in the jacobian, and the size of the output explaining map.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">cams</span><span class="o">.</span><span class="n">scorecam</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Score-CAM: Score-Weighted Visual Explanations for Convolutional
Neural Networks. Available at:
<a class="reference external" href="https://arxiv.org/abs/1910.01279">arxiv/1910.01279</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and Class Activation Maps (CAMs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-keras_explainable.methods.gradient">
<span id="keras-explainable-methods-gradient-module"></span><h2>keras_explainable.methods.gradient module<a class="headerlink" href="#module-keras_explainable.methods.gradient" title="Permalink to this heading">¶</a></h2>
<p>Implementation of various Gradient-based AI explaining methods and techniques.</p>
<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.gradient.full_gradients">
<span class="sig-name descname"><span class="pre">full_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis=(-3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi=&lt;function</span> <span class="pre">absolute_normalize&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/gradient.html#full_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.gradient.full_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Full-Grad Visualization Method.</p>
<p>This technique adds the individual contributions of each bias factor
in the model to the extracted gradient, forming the “full gradient”
representation, and it can be summarized by the following equation:</p>
<div class="math notranslate nohighlight">
\[f(x) = ψ(∇_xf(x)\odot x) +∑_{l\in L}∑_{c\in c_l} ψ(f^b(x)_c)\]</div>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <cite>L</cite> is the number of labels
represented within the model’s output logits.</p>
<p>If <cite>indices</cite> is passed, the specific logits indexed by elements in this
tensor are selected before the gradients are computed, effectively
reducing the columns in the jacobian, and the size of the output explaining map.</p>
<p>Furthermore, the cached list of <code class="docutils literal notranslate"><span class="pre">biases</span></code> can be passed as a parameter for this
method. If none is passed, it will be inferred at runtime, implying on a marginal
increase in execution overhead during tracing.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">logits</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">get_logits_layer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">inters</span><span class="p">,</span> <span class="n">biases</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">layers_with_biases</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">logits</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">inspection</span><span class="o">.</span><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inters</span><span class="p">,</span> <span class="n">logits</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">gradient</span><span class="o">.</span><span class="n">full_gradients</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">biases</span><span class="o">=</span><span class="n">biases</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Srinivas S, Fleuret F. Full-gradient representation for neural network
visualization. <a class="reference external" href="https://arxiv.org/pdf/1905.00780.pdf">arxiv.org/1905.00780</a>,
2019.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
<li><p><strong>psi</strong> (<em>Callable</em><em>, </em><em>optional</em>) – filter operation before combining the intermediate
signals. Defaults to <code class="docutils literal notranslate"><span class="pre">filters.absolute_normalize</span></code>.</p></li>
<li><p><strong>biases</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.List" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]) – (List[tf.Tensor], optional): list of biases associated with each
intermediate signal exposed by the model. If none is passed, it will
be inferred from the endpoints (nodes) outputed by the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and saliency maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.gradient.gradients">
<span class="sig-name descname"><span class="pre">gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_axis=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_batch_dims=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_axis=(-3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_filter=&lt;function</span> <span class="pre">abs&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/gradient.html#gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.gradient.gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Gradient Back-propagation Visualization Method.</p>
<p>This technique computes the gradient of the output activation unit being explained
with respect to each unit in the input signal.
Features (channels) in each pixel of the input sinal are absolutely averaged,
following the original implementation:</p>
<div class="math notranslate nohighlight">
\[f(x) = ψ(∇_xf(x))\]</div>
<p>This method expects <cite>inputs</cite> to be a batch of positional signals of
shape <code class="docutils literal notranslate"><span class="pre">BHW...C</span></code>, and will return a tensor of shape <code class="docutils literal notranslate"><span class="pre">BH'W'...L</span></code>,
where <code class="docutils literal notranslate"><span class="pre">(H',</span> <span class="pre">W',</span> <span class="pre">...)</span></code> are the sizes of the visual receptive field
in the explained activation layer and <cite>L</cite> is the number of labels
represented within the model’s output logits.</p>
<p>If <cite>indices</cite> is passed, the specific logits indexed by elements in this
tensor are selected before the gradients are computed, effectively
reducing the columns in the jacobian, and the size of the output explaining map.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">scores</span><span class="p">,</span> <span class="n">cams</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">gradient</span><span class="o">.</span><span class="n">gradients</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Simonyan, K., Vedaldi, A., &amp; Zisserman, A. (2013).
Deep inside convolutional networks: Visualising image classification
models and saliency maps. arXiv preprint
<a class="reference external" href="https://arxiv.org/abs/1312.6034">arXiv:1312.6034</a>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – the model being explained</p></li>
<li><p><strong>inputs</strong> (<em>tf.Tensor</em>) – the input data</p></li>
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em><em>, </em><em>optional</em>) – indices that should be gathered
from <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. Defaults to None.</p></li>
<li><p><strong>indices_axis</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis containing the indices to gather.
Defaults to <code class="docutils literal notranslate"><span class="pre">KERNEL_AXIS</span></code>.</p></li>
<li><p><strong>indices_batch_dims</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the number of dimensions to broadcast
in the <code class="docutils literal notranslate"><span class="pre">tf.gather</span></code> operation. Defaults to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><strong>spatial_axis</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – the dimensions containing positional
information. Defaults to <code class="docutils literal notranslate"><span class="pre">SPATIAL_AXIS</span></code>.</p></li>
<li><p><strong>gradient_filter</strong> (<em>Callable</em><em>, </em><em>optional</em>) – filter before channel combining.
Defaults to <code class="docutils literal notranslate"><span class="pre">tf.abs</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and saliency maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-keras_explainable.methods.meta">
<span id="keras-explainable-methods-meta-module"></span><h2>keras_explainable.methods.meta module<a class="headerlink" href="#module-keras_explainable.methods.meta" title="Permalink to this heading">¶</a></h2>
<p>Implementation of various Meta techniques.</p>
<p>These can be used conjointly with CAM and Gradient-based methods,
providing cleaner and more robust results.</p>
<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.meta.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repetitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/meta.html#smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.meta.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth Meta Explaining Method.</p>
<p>This technique consists of repeatedly applying an AI explaining method, considering
small variations of the input signal each time (tempered with gaussian noise).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">smoothgrad</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span>
    <span class="n">ke</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">gradient</span><span class="o">.</span><span class="n">gradients</span><span class="p">,</span>
    <span class="n">repetitions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">maps</span> <span class="o">=</span> <span class="n">smoothgrad</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Smilkov, D., Thorat, N., Kim, B., Viégas, F., &amp; Wattenberg, M. (2017).
SmoothGrad: removing noise by adding noise. arXiv preprint arXiv:1706.03825.
Available at: [arxiv/1706.03825](https://arxiv.org/abs/1706.03825)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>Callable</em>) – the explaining method to be smoothed</p></li>
<li><p><strong>repetitions</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of repetitions. Defaults to 20.</p></li>
<li><p><strong>noise</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – standard deviation of the gaussian noise
added to the input signal. Defaults to 0.1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and explaining maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="keras_explainable.methods.meta.tta">
<span class="sig-name descname"><span class="pre">tta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">1.5,</span> <span class="pre">2.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hflip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resize_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/keras_explainable/methods/meta.html#tta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#keras_explainable.methods.meta.tta" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the TTA version of a visualization method.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">ResNet50V2</span><span class="p">(</span><span class="n">classifier_activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">scores</span><span class="p">,</span> <span class="n">maps</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span>
    <span class="n">methods</span><span class="o">.</span><span class="n">gradient</span><span class="o">.</span><span class="n">gradients</span><span class="p">,</span>
    <span class="n">rn50</span><span class="p">,</span>
    <span class="n">inputs</span><span class="p">,</span>
    <span class="n">explaining_units</span><span class="p">,</span>
    <span class="n">postprocessing</span><span class="o">=</span><span class="n">filters</span><span class="o">.</span><span class="n">absolute_normalize</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>Callable</em>) – the explaining method to be augmented</p></li>
<li><p><strong>scales</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – a list of coefs to scale the inputs by.
Defaults to [0.5, 1.5, 2.0].</p></li>
<li><p><strong>hflip</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – wether or not to flip horizontally the inputs.
Defaults to True.</p></li>
<li><p><strong>resize_method</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the resizing method used. Defaults to “bilinear”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the logits and explaining maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-keras_explainable.methods">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-keras_explainable.methods" title="Permalink to this heading">¶</a></h2>
</section>
</section>


            </div>

        </section>

        
            <nav class="site-bottom-navigation" role="navigation">
            
            
                <a href="keras_explainable.engine.html" class="btn btn--primary btn--prev"
                    title="keras_explainable.engine package" accesskey="p">
                    Previous
                </a>
            
            </nav>
        

        
            <div class="source-link">
            
                
                    <a href="../_sources/api/keras_explainable.methods.rst.txt" rel="nofollow">
                        <i class="mdi mdi-code-tags"></i>
                        View page source
                    </a>
                
            
            </div>
        



    </main>

    <footer class="site-footer">
<div class="container">

    <div role="contentinfo">
        <p>
                &copy; Copyright 2022, Lucas David.
        </p>
    </div> 

</div>
</footer>

    

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'',
            VERSION:'0.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../_static/thebelab-helper.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../_static/js/theme-min.js"></script> 
</body>
</html>